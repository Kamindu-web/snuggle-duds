{% doc %}
  @prompt
    Modern Shopify website UI mockup for a premium custom T-shirt brand called Snuggle Duds Australia. Soft coral and neutral color palette, clean white layout, rounded buttons, lifestyle hero image with family wearing matching shirts, card-based sections, product grid, live customizer layout with left preview and right control panel, minimal premium design, mobile responsive, high conversion eCommerce layout., i need t shirt, hoodies, cap, hat, bag, shorts mockup design . there need to change t shirt sample i have. need to select option our design. Add option need to change size location and rotation. need option to customer upload design. select option size ,send e mail to me and  get quart , customer description . select place option Front chest,Full chest, left chest, Full Back, Top Back, sleeves, i need t shirt, hoodies, cap, hat, bag, shorts mockup design .
    
    then
    when select t shirt - adalt, kids 
    01) Adalt - 2 option man or wemen
    02) kids - 2 option girl or boy
    
    or
    when select hoodies - adalt, kids 
    01) Adalt - 2 option man or wemen
    02) kids - 2 option girl or boy
    
    for t shirt and hoodies select place option Front chest,Full chest, left chest, Full Back, Top Back, sleevs. 
     
     
    there need to change t shirt sample i have uploded. 
    need to select option our design.
    
    add option need to change size location and rotation on display gizmo. need option to customer upload design. select option size ,send e mail to me and  get quart , customer description . 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-apparel-customizer-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    background-color: {{ block.settings.background_color }};
    padding: {{ block.settings.section_padding }}px 20px;
  }

  .ai-apparel-customizer-container-{{ ai_gen_id }} {
    max-width: {{ block.settings.max_width }}px;
    margin: 0 auto;
  }

  .ai-apparel-customizer-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.title_size }}px;
    color: {{ block.settings.text_color }};
    text-align: center;
    margin: 0 0 48px;
    font-weight: 700;
  }

  .ai-apparel-customizer-layout-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: 1.3fr 1fr;
    gap: 48px;
  }

  .ai-apparel-customizer-preview-panel-{{ ai_gen_id }} {
    background-color: {{ block.settings.preview_bg_color }};
    border-radius: {{ block.settings.border_radius }}px;
    padding: 40px;
    position: sticky;
    top: 20px;
    height: fit-content;
  }

  .ai-apparel-customizer-mockup-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    background-color: #f5f5f5;
    border-radius: {{ block.settings.border_radius }}px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 24px;
  }

  .ai-apparel-customizer-mockup-img-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: none;
  }

  .ai-apparel-customizer-mockup-img-{{ ai_gen_id }}.active {
    display: block;
  }

  .ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: none;
    align-items: center;
    justify-content: center;
    background-color: #f9f9f9;
  }

  .ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}.active {
    display: flex;
  }

  .ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }} svg {
    width: 60%;
    height: 60%;
    opacity: 0.2;
  }

  .ai-apparel-customizer-design-canvas-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  .ai-apparel-customizer-design-element-{{ ai_gen_id }} {
    position: absolute;
    cursor: move;
    pointer-events: auto;
    display: none;
  }

  .ai-apparel-customizer-design-element-{{ ai_gen_id }}.active {
    display: block;
  }

  .ai-apparel-customizer-design-element-{{ ai_gen_id }} img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    user-select: none;
  }

  .ai-apparel-customizer-gizmo-{{ ai_gen_id }} {
    position: absolute;
    border: 2px dashed {{ block.settings.accent_color }};
    pointer-events: none;
    display: none;
  }

  .ai-apparel-customizer-gizmo-{{ ai_gen_id }}.active {
    display: block;
  }

  .ai-apparel-customizer-gizmo-handle-{{ ai_gen_id }} {
    position: absolute;
    width: 12px;
    height: 12px;
    background-color: {{ block.settings.accent_color }};
    border: 2px solid #ffffff;
    border-radius: 50%;
    pointer-events: auto;
    cursor: pointer;
  }

  .ai-apparel-customizer-gizmo-handle-{{ ai_gen_id }}.resize {
    bottom: -6px;
    right: -6px;
    cursor: nwse-resize;
  }

  .ai-apparel-customizer-gizmo-handle-{{ ai_gen_id }}.rotate {
    top: -6px;
    right: -6px;
    cursor: grab;
  }

  .ai-apparel-customizer-controls-panel-{{ ai_gen_id }} {
    background-color: {{ block.settings.card_bg_color }};
    border-radius: {{ block.settings.border_radius }}px;
    padding: 36px;
  }

  .ai-apparel-customizer-control-section-{{ ai_gen_id }} {
    margin-bottom: 32px;
    padding-bottom: 32px;
    border-bottom: 1px solid {{ block.settings.border_color }};
  }

  .ai-apparel-customizer-control-section-{{ ai_gen_id }}:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
  }

  .ai-apparel-customizer-control-title-{{ ai_gen_id }} {
    display: block;
    font-size: 13px;
    font-weight: 700;
    color: {{ block.settings.text_color }};
    margin-bottom: 16px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
  }

  .ai-apparel-customizer-tabs-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-bottom: 16px;
  }

  .ai-apparel-customizer-tab-{{ ai_gen_id }} {
    padding: 12px 16px;
    background-color: #ffffff;
    border: 2px solid {{ block.settings.border_color }};
    border-radius: {{ block.settings.button_radius }}px;
    cursor: pointer;
    text-align: center;
    font-size: 13px;
    font-weight: 600;
    color: {{ block.settings.text_color }};
    transition: all 0.3s ease;
  }

  .ai-apparel-customizer-tab-{{ ai_gen_id }}:hover,
  .ai-apparel-customizer-tab-{{ ai_gen_id }}.active {
    background-color: {{ block.settings.accent_color }};
    border-color: {{ block.settings.accent_color }};
    color: #ffffff;
  }

  .ai-apparel-customizer-options-grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
  }

  .ai-apparel-customizer-option-btn-{{ ai_gen_id }} {
    padding: 14px 20px;
    background-color: #ffffff;
    border: 2px solid {{ block.settings.border_color }};
    border-radius: {{ block.settings.button_radius }}px;
    cursor: pointer;
    text-align: center;
    font-size: 14px;
    font-weight: 600;
    color: {{ block.settings.text_color }};
    transition: all 0.3s ease;
  }

  .ai-apparel-customizer-option-btn-{{ ai_gen_id }}:hover,
  .ai-apparel-customizer-option-btn-{{ ai_gen_id }}.active {
    background-color: {{ block.settings.accent_color }};
    border-color: {{ block.settings.accent_color }};
    color: #ffffff;
  }

  .ai-apparel-customizer-placement-grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }

  .ai-apparel-customizer-upload-zone-{{ ai_gen_id }} {
    border: 2px dashed {{ block.settings.border_color }};
    border-radius: {{ block.settings.border_radius }}px;
    padding: 36px 24px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background-color: #fafafa;
  }

  .ai-apparel-customizer-upload-zone-{{ ai_gen_id }}:hover {
    border-color: {{ block.settings.accent_color }};
    background-color: #f0f0f0;
  }

  .ai-apparel-customizer-upload-icon-{{ ai_gen_id }} {
    font-size: 52px;
    margin-bottom: 12px;
  }

  .ai-apparel-customizer-upload-text-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.text_color }};
    margin: 0;
  }

  .ai-apparel-customizer-file-input-{{ ai_gen_id }} {
    display: none;
  }

  .ai-apparel-customizer-preview-thumb-{{ ai_gen_id }} {
    width: 100%;
    max-width: 160px;
    margin: 16px auto 0;
    border-radius: 8px;
    overflow: hidden;
    display: none;
  }

  .ai-apparel-customizer-preview-thumb-{{ ai_gen_id }} img {
    width: 100%;
    height: auto;
    display: block;
  }

  .ai-apparel-customizer-input-{{ ai_gen_id }} {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid {{ block.settings.border_color }};
    border-radius: {{ block.settings.button_radius }}px;
    font-size: 14px;
    color: {{ block.settings.text_color }};
    transition: all 0.3s ease;
  }

  .ai-apparel-customizer-input-{{ ai_gen_id }}:focus {
    outline: none;
    border-color: {{ block.settings.accent_color }};
  }

  .ai-apparel-customizer-textarea-{{ ai_gen_id }} {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid {{ block.settings.border_color }};
    border-radius: {{ block.settings.button_radius }}px;
    font-size: 14px;
    color: {{ block.settings.text_color }};
    min-height: 110px;
    resize: vertical;
    font-family: inherit;
    transition: all 0.3s ease;
  }

  .ai-apparel-customizer-textarea-{{ ai_gen_id }}:focus {
    outline: none;
    border-color: {{ block.settings.accent_color }};
  }

  .ai-apparel-customizer-size-grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }

  .ai-apparel-customizer-submit-btn-{{ ai_gen_id }} {
    width: 100%;
    padding: 18px 36px;
    background-color: {{ block.settings.button_bg_color }};
    color: {{ block.settings.button_text_color }};
    border: none;
    border-radius: {{ block.settings.button_radius }}px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1.2px;
  }

  .ai-apparel-customizer-submit-btn-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_bg_color }};
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .ai-apparel-customizer-success-msg-{{ ai_gen_id }} {
    background-color: #d4edda;
    color: #155724;
    padding: 18px;
    border-radius: {{ block.settings.button_radius }}px;
    margin-top: 20px;
    text-align: center;
    display: none;
  }

  .ai-apparel-customizer-error-msg-{{ ai_gen_id }} {
    background-color: #f8d7da;
    color: #721c24;
    padding: 18px;
    border-radius: {{ block.settings.button_radius }}px;
    margin-top: 20px;
    text-align: center;
    display: none;
  }

  @media screen and (max-width: 990px) {
    .ai-apparel-customizer-layout-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
      gap: 32px;
    }

    .ai-apparel-customizer-preview-panel-{{ ai_gen_id }} {
      position: relative;
      top: 0;
    }

    .ai-apparel-customizer-tabs-{{ ai_gen_id }} {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media screen and (max-width: 749px) {
    .ai-apparel-customizer-placement-grid-{{ ai_gen_id }} {
      grid-template-columns: repeat(2, 1fr);
    }

    .ai-apparel-customizer-size-grid-{{ ai_gen_id }} {
      grid-template-columns: repeat(2, 1fr);
    }
  }
{% endstyle %}

<ai-apparel-customizer-{{ ai_gen_id }} class="ai-apparel-customizer-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-apparel-customizer-container-{{ ai_gen_id }}">
    {% if block.settings.title != blank %}
      <h2 class="ai-apparel-customizer-title-{{ ai_gen_id }}">{{ block.settings.title }}</h2>
    {% endif %}

    <div class="ai-apparel-customizer-layout-{{ ai_gen_id }}">
      <div class="ai-apparel-customizer-preview-panel-{{ ai_gen_id }}">
        <div class="ai-apparel-customizer-mockup-wrapper-{{ ai_gen_id }}">
          {% if block.settings.tshirt_man_mockup %}
            <img src="{{ block.settings.tshirt_man_mockup | image_url: width: 900 }}" alt="T-Shirt Man" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }} active" data-mockup="tshirt-adult-man" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }} active" data-mockup="tshirt-adult-man">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.tshirt_woman_mockup %}
            <img src="{{ block.settings.tshirt_woman_mockup | image_url: width: 900 }}" alt="T-Shirt Woman" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="tshirt-adult-woman" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="tshirt-adult-woman">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.tshirt_boy_mockup %}
            <img src="{{ block.settings.tshirt_boy_mockup | image_url: width: 900 }}" alt="T-Shirt Boy" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="tshirt-kids-boy" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="tshirt-kids-boy">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.tshirt_girl_mockup %}
            <img src="{{ block.settings.tshirt_girl_mockup | image_url: width: 900 }}" alt="T-Shirt Girl" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="tshirt-kids-girl" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="tshirt-kids-girl">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.hoodie_man_mockup %}
            <img src="{{ block.settings.hoodie_man_mockup | image_url: width: 900 }}" alt="Hoodie Man" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="hoodie-adult-man" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="hoodie-adult-man">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.hoodie_woman_mockup %}
            <img src="{{ block.settings.hoodie_woman_mockup | image_url: width: 900 }}" alt="Hoodie Woman" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="hoodie-adult-woman" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="hoodie-adult-woman">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.hoodie_boy_mockup %}
            <img src="{{ block.settings.hoodie_boy_mockup | image_url: width: 900 }}" alt="Hoodie Boy" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="hoodie-kids-boy" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="hoodie-kids-boy">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.hoodie_girl_mockup %}
            <img src="{{ block.settings.hoodie_girl_mockup | image_url: width: 900 }}" alt="Hoodie Girl" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="hoodie-kids-girl" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="hoodie-kids-girl">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.cap_mockup %}
            <img src="{{ block.settings.cap_mockup | image_url: width: 900 }}" alt="Cap" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="cap" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="cap">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.hat_mockup %}
            <img src="{{ block.settings.hat_mockup | image_url: width: 900 }}" alt="Hat" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="hat" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="hat">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.bag_mockup %}
            <img src="{{ block.settings.bag_mockup | image_url: width: 900 }}" alt="Bag" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="bag" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="bag">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          {% if block.settings.shorts_mockup %}
            <img src="{{ block.settings.shorts_mockup | image_url: width: 900 }}" alt="Shorts" class="ai-apparel-customizer-mockup-img-{{ ai_gen_id }}" data-mockup="shorts" loading="lazy">
          {% else %}
            <div class="ai-apparel-customizer-mockup-placeholder-{{ ai_gen_id }}" data-mockup="shorts">{{ 'product-apparel-1' | placeholder_svg_tag }}</div>
          {% endif %}

          <div class="ai-apparel-customizer-design-canvas-{{ ai_gen_id }}">
            <div class="ai-apparel-customizer-design-element-{{ ai_gen_id }}" style="top: 30%; left: 50%; width: 150px; height: 150px; transform: translate(-50%, -50%) rotate(0deg);"></div>
            <div class="ai-apparel-customizer-gizmo-{{ ai_gen_id }}">
              <div class="ai-apparel-customizer-gizmo-handle-{{ ai_gen_id }} resize"></div>
              <div class="ai-apparel-customizer-gizmo-handle-{{ ai_gen_id }} rotate"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="ai-apparel-customizer-controls-panel-{{ ai_gen_id }}">
        {%- form 'contact' -%}
          <input type="hidden" name="contact[subject]" value="Custom Apparel Quote Request">

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}">Select Product</label>
            <div class="ai-apparel-customizer-tabs-{{ ai_gen_id }}">
              <button type="button" class="ai-apparel-customizer-tab-{{ ai_gen_id }} active" data-product="tshirt">T-Shirt</button>
              <button type="button" class="ai-apparel-customizer-tab-{{ ai_gen_id }}" data-product="hoodie">Hoodie</button>
              <button type="button" class="ai-apparel-customizer-tab-{{ ai_gen_id }}" data-product="cap">Cap</button>
              <button type="button" class="ai-apparel-customizer-tab-{{ ai_gen_id }}" data-product="hat">Hat</button>
              <button type="button" class="ai-apparel-customizer-tab-{{ ai_gen_id }}" data-product="bag">Bag</button>
              <button type="button" class="ai-apparel-customizer-tab-{{ ai_gen_id }}" data-product="shorts">Shorts</button>
            </div>
            <input type="hidden" name="contact[product_type]" id="productTypeInput{{ ai_gen_id }}" value="tshirt">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}" id="categorySection{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}">Category</label>
            <div class="ai-apparel-customizer-options-grid-{{ ai_gen_id }}">
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }} active" data-category="adult">Adult</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-category="kids">Kids</button>
            </div>
            <input type="hidden" name="contact[category]" id="categoryInput{{ ai_gen_id }}" value="adult">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}" id="genderSection{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}">Gender</label>
            <div class="ai-apparel-customizer-options-grid-{{ ai_gen_id }}" id="adultGender{{ ai_gen_id }}">
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }} active" data-gender="man">Man</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-gender="woman">Woman</button>
            </div>
            <div class="ai-apparel-customizer-options-grid-{{ ai_gen_id }}" id="kidsGender{{ ai_gen_id }}" style="display: none;">
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-gender="boy">Boy</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-gender="girl">Girl</button>
            </div>
            <input type="hidden" name="contact[gender]" id="genderInput{{ ai_gen_id }}" value="man">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}" id="placementSection{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}">Design Placement</label>
            <div class="ai-apparel-customizer-placement-grid-{{ ai_gen_id }}">
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }} active" data-placement="front-chest">Front Chest</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-placement="full-chest">Full Chest</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-placement="left-chest">Left Chest</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-placement="full-back">Full Back</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-placement="top-back">Top Back</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-placement="sleeves">Sleeves</button>
            </div>
            <input type="hidden" name="contact[placement]" id="placementInput{{ ai_gen_id }}" value="front-chest">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}">Upload Your Design</label>
            <div class="ai-apparel-customizer-upload-zone-{{ ai_gen_id }}" id="uploadZone{{ ai_gen_id }}">
              <div class="ai-apparel-customizer-upload-icon-{{ ai_gen_id }}">ðŸ“¤</div>
              <p class="ai-apparel-customizer-upload-text-{{ ai_gen_id }}">Click to upload or drag & drop<br><small>PNG, JPG, SVG (Max 5MB)</small></p>
              <input type="file" class="ai-apparel-customizer-file-input-{{ ai_gen_id }}" id="designUpload{{ ai_gen_id }}" accept="image/png,image/jpeg,image/svg+xml">
              <div class="ai-apparel-customizer-preview-thumb-{{ ai_gen_id }}" id="previewThumb{{ ai_gen_id }}">
                <img src="" alt="Design preview">
              </div>
            </div>
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}">Select Size</label>
            <div class="ai-apparel-customizer-size-grid-{{ ai_gen_id }}">
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-size="xs">XS</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-size="s">S</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }} active" data-size="m">M</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-size="l">L</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-size="xl">XL</button>
              <button type="button" class="ai-apparel-customizer-option-btn-{{ ai_gen_id }}" data-size="xxl">XXL</button>
            </div>
            <input type="hidden" name="contact[size]" id="sizeInput{{ ai_gen_id }}" value="m">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}" for="customerName{{ ai_gen_id }}">Your Name *</label>
            <input type="text" class="ai-apparel-customizer-input-{{ ai_gen_id }}" id="customerName{{ ai_gen_id }}" name="contact[name]" required placeholder="Enter your name">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}" for="customerEmail{{ ai_gen_id }}">Your Email *</label>
            <input type="email" class="ai-apparel-customizer-input-{{ ai_gen_id }}" id="customerEmail{{ ai_gen_id }}" name="contact[email]" required placeholder="your@email.com">
          </div>

          <div class="ai-apparel-customizer-control-section-{{ ai_gen_id }}">
            <label class="ai-apparel-customizer-control-title-{{ ai_gen_id }}" for="customerDescription{{ ai_gen_id }}">Additional Details</label>
            <textarea class="ai-apparel-customizer-textarea-{{ ai_gen_id }}" id="customerDescription{{ ai_gen_id }}" name="contact[description]" placeholder="Quantity needed, colors, special requirements, etc."></textarea>
          </div>

          <input type="hidden" name="contact[design_position]" id="designPositionInput{{ ai_gen_id }}" value="">
          <input type="hidden" name="contact[design_size]" id="designSizeInput{{ ai_gen_id }}" value="">
          <input type="hidden" name="contact[design_rotation]" id="designRotationInput{{ ai_gen_id }}" value="">

          <button type="submit" class="ai-apparel-customizer-submit-btn-{{ ai_gen_id }}">
            {{ block.settings.submit_button_text }}
          </button>

          {%- if form.posted_successfully? -%}
            <div class="ai-apparel-customizer-success-msg-{{ ai_gen_id }}" style="display: block;">
              {{ block.settings.success_message }}
            </div>
          {%- endif -%}

          {%- if form.errors -%}
            <div class="ai-apparel-customizer-error-msg-{{ ai_gen_id }}" style="display: block;">
              Please fill in all required fields correctly.
            </div>
          {%- endif -%}
        {%- endform -%}
      </div>
    </div>
  </div>
</ai-apparel-customizer-{{ ai_gen_id }}>

<script>
  (function() {
    class AiApparelCustomizer{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.currentProduct = 'tshirt';
        this.currentCategory = 'adult';
        this.currentGender = 'man';
        this.designElement = null;
        this.gizmo = null;
        this.isDragging = false;
        this.isResizing = false;
        this.isRotating = false;
        this.startX = 0;
        this.startY = 0;
        this.startWidth = 0;
        this.startHeight = 0;
        this.startRotation = 0;
      }

      connectedCallback() {
        this.designElement = this.querySelector('.ai-apparel-customizer-design-element-{{ ai_gen_id }}');
        this.gizmo = this.querySelector('.ai-apparel-customizer-gizmo-{{ ai_gen_id }}');
        
        this.setupProductTabs();
        this.setupCategoryOptions();
        this.setupGenderOptions();
        this.setupPlacementOptions();
        this.setupSizeOptions();
        this.setupFileUpload();
        this.setupGizmo();
        this.updateMockup();
      }

      setupProductTabs() {
        const tabs = this.querySelectorAll('[data-product]');
        const productInput = this.querySelector('#productTypeInput{{ ai_gen_id }}');
        const categorySection = this.querySelector('#categorySection{{ ai_gen_id }}');
        const genderSection = this.querySelector('#genderSection{{ ai_gen_id }}');
        const placementSection = this.querySelector('#placementSection{{ ai_gen_id }}');

        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            this.currentProduct = tab.getAttribute('data-product');
            productInput.value = this.currentProduct;

            if (this.currentProduct === 'tshirt' || this.currentProduct === 'hoodie') {
              categorySection.style.display = 'block';
              genderSection.style.display = 'block';
              placementSection.style.display = 'block';
            } else {
              categorySection.style.display = 'none';
              genderSection.style.display = 'none';
              placementSection.style.display = 'none';
            }

            this.updateMockup();
          });
        });
      }

      setupCategoryOptions() {
        const buttons = this.querySelectorAll('[data-category]');
        const categoryInput = this.querySelector('#categoryInput{{ ai_gen_id }}');
        const adultGender = this.querySelector('#adultGender{{ ai_gen_id }}');
        const kidsGender = this.querySelector('#kidsGender{{ ai_gen_id }}');

        buttons.forEach(button => {
          button.addEventListener('click', () => {
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            this.currentCategory = button.getAttribute('data-category');
            categoryInput.value = this.currentCategory;

            if (this.currentCategory === 'adult') {
              adultGender.style.display = 'grid';
              kidsGender.style.display = 'none';
              this.currentGender = 'man';
              adultGender.querySelector('[data-gender="man"]').classList.add('active');
              adultGender.querySelector('[data-gender="woman"]').classList.remove('active');
            } else {
              adultGender.style.display = 'none';
              kidsGender.style.display = 'grid';
              this.currentGender = 'boy';
              kidsGender.querySelector('[data-gender="boy"]').classList.add('active');
              kidsGender.querySelector('[data-gender="girl"]').classList.remove('active');
            }

            this.querySelector('#genderInput{{ ai_gen_id }}').value = this.currentGender;
            this.updateMockup();
          });
        });
      }

      setupGenderOptions() {
        const buttons = this.querySelectorAll('[data-gender]');
        const genderInput = this.querySelector('#genderInput{{ ai_gen_id }}');

        buttons.forEach(button => {
          button.addEventListener('click', () => {
            const parentGrid = button.parentElement;
            parentGrid.querySelectorAll('[data-gender]').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            this.currentGender = button.getAttribute('data-gender');
            genderInput.value = this.currentGender;
            this.updateMockup();
          });
        });
      }

      setupPlacementOptions() {
        const buttons = this.querySelectorAll('[data-placement]');
        const placementInput = this.querySelector('#placementInput{{ ai_gen_id }}');

        buttons.forEach(button => {
          button.addEventListener('click', () => {
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            placementInput.value = button.getAttribute('data-placement');
          });
        });
      }

      setupSizeOptions() {
        const buttons = this.querySelectorAll('[data-size]');
        const sizeInput = this.querySelector('#sizeInput{{ ai_gen_id }}');

        buttons.forEach(button => {
          button.addEventListener('click', () => {
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            sizeInput.value = button.getAttribute('data-size');
          });
        });
      }

      setupFileUpload() {
        const uploadZone = this.querySelector('#uploadZone{{ ai_gen_id }}');
        const fileInput = this.querySelector('#designUpload{{ ai_gen_id }}');
        const previewThumb = this.querySelector('#previewThumb{{ ai_gen_id }}');

        uploadZone.addEventListener('click', () => fileInput.click());

        fileInput.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (event) => {
              const designUrl = event.target.result;
              previewThumb.querySelector('img').src = designUrl;
              previewThumb.style.display = 'block';
              
              this.designElement.innerHTML = '<img src="' + designUrl + '" alt="Custom design">';
              this.designElement.classList.add('active');
              this.gizmo.classList.add('active');
              this.updateGizmoPosition();
            };
            reader.readAsDataURL(file);
          }
        });

        uploadZone.addEventListener('dragover', (e) => {
          e.preventDefault();
          uploadZone.style.borderColor = '{{ block.settings.accent_color }}';
        });

        uploadZone.addEventListener('dragleave', () => {
          uploadZone.style.borderColor = '{{ block.settings.border_color }}';
        });

        uploadZone.addEventListener('drop', (e) => {
          e.preventDefault();
          uploadZone.style.borderColor = '{{ block.settings.border_color }}';
          
          const file = e.dataTransfer.files[0];
          if (file && file.type.startsWith('image/')) {
            fileInput.files = e.dataTransfer.files;
            fileInput.dispatchEvent(new Event('change'));
          }
        });
      }

      setupGizmo() {
        const resizeHandle = this.gizmo.querySelector('.resize');
        const rotateHandle = this.gizmo.querySelector('.rotate');

        this.designElement.addEventListener('mousedown', (e) => {
          if (e.target === this.designElement || e.target.tagName === 'IMG') {
            this.isDragging = true;
            this.startX = e.clientX;
            this.startY = e.clientY;
            const rect = this.designElement.getBoundingClientRect();
            const parentRect = this.designElement.parentElement.getBoundingClientRect();
            this.startLeft = ((rect.left + rect.width / 2 - parentRect.left) / parentRect.width) * 100;
            this.startTop = ((rect.top + rect.height / 2 - parentRect.top) / parentRect.height) * 100;
          }
        });

        resizeHandle.addEventListener('mousedown', (e) => {
          e.stopPropagation();
          this.isResizing = true;
          this.startX = e.clientX;
          this.startY = e.clientY;
          this.startWidth = this.designElement.offsetWidth;
          this.startHeight = this.designElement.offsetHeight;
        });

        rotateHandle.addEventListener('mousedown', (e) => {
          e.stopPropagation();
          this.isRotating = true;
          const rect = this.designElement.getBoundingClientRect();
          const centerX = rect.left + rect.width / 2;
          const centerY = rect.top + rect.height / 2;
          this.centerX = centerX;
          this.centerY = centerY;
          this.startRotation = this.getRotation();
        });

        document.addEventListener('mousemove', (e) => {
          if (this.isDragging) {
            const deltaX = e.clientX - this.startX;
            const deltaY = e.clientY - this.startY;
            const parentRect = this.designElement.parentElement.getBoundingClientRect();
            const newLeft = this.startLeft + (deltaX / parentRect.width) * 100;
            const newTop = this.startTop + (deltaY / parentRect.height) * 100;
            
            this.designElement.style.left = Math.max(10, Math.min(90, newLeft)) + '%';
            this.designElement.style.top = Math.max(10, Math.min(90, newTop)) + '%';
            this.updateGizmoPosition();
            this.saveDesignData();
          } else if (this.isResizing) {
            const deltaX = e.clientX - this.startX;
            const newWidth = Math.max(50, this.startWidth + deltaX);
            const newHeight = Math.max(50, this.startHeight + deltaX);
            
            this.designElement.style.width = newWidth + 'px';
            this.designElement.style.height = newHeight + 'px';
            this.updateGizmoPosition();
            this.saveDesignData();
          } else if (this.isRotating) {
            const angle = Math.atan2(e.clientY - this.centerY, e.clientX - this.centerX);
            const rotation = angle * (180 / Math.PI);
            this.setRotation(rotation);
            this.updateGizmoPosition();
            this.saveDesignData();
          }
        });

        document.addEventListener('mouseup', () => {
          this.isDragging = false;
          this.isResizing = false;
          this.isRotating = false;
        });
      }

      updateGizmoPosition() {
        const rect = this.designElement.getBoundingClientRect();
        const parentRect = this.designElement.parentElement.getBoundingClientRect();
        
        this.gizmo.style.left = (rect.left - parentRect.left) + 'px';
        this.gizmo.style.top = (rect.top - parentRect.top) + 'px';
        this.gizmo.style.width = rect.width + 'px';
        this.gizmo.style.height = rect.height + 'px';
        this.gizmo.style.transform = 'rotate(' + this.getRotation() + 'deg)';
      }

      getRotation() {
        const transform = this.designElement.style.transform;
        const match = transform.match(/rotate\(([^)]+)deg\)/);
        return match ? parseFloat(match[1]) : 0;
      }

      setRotation(degrees) {
        const currentTransform = this.designElement.style.transform;
        const newTransform = currentTransform.replace(/rotate\([^)]+\)/, '') + ' rotate(' + degrees + 'deg)';
        this.designElement.style.transform = newTransform;
      }

      saveDesignData() {
        const left = parseFloat(this.designElement.style.left);
        const top = parseFloat(this.designElement.style.top);
        const width = this.designElement.offsetWidth;
        const rotation = this.getRotation();

        this.querySelector('#designPositionInput{{ ai_gen_id }}').value = 'Left: ' + left.toFixed(1) + '%, Top: ' + top.toFixed(1) + '%';
        this.querySelector('#designSizeInput{{ ai_gen_id }}').value = width + 'px';
        this.querySelector('#designRotationInput{{ ai_gen_id }}').value = rotation.toFixed(1) + 'Â°';
      }

      updateMockup() {
        const mockups = this.querySelectorAll('[data-mockup]');
        let targetMockup = this.currentProduct;

        if (this.currentProduct === 'tshirt' || this.currentProduct === 'hoodie') {
          targetMockup = this.currentProduct + '-' + this.currentCategory + '-' + this.currentGender;
        }

        mockups.forEach(mockup => {
          if (mockup.getAttribute('data-mockup') === targetMockup) {
            mockup.classList.add('active');
            if (mockup.tagName === 'IMG') {
              mockup.style.display = 'block';
            } else {
              mockup.style.display = 'flex';
            }
          } else {
            mockup.classList.remove('active');
            mockup.style.display = 'none';
          }
        });
      }
    }

    customElements.define('ai-apparel-customizer-{{ ai_gen_id }}', AiApparelCustomizer{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Apparel customizer",
  "settings": [
    {
      "type": "header",
      "content": "General"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section title",
      "default": "Design Your Custom Apparel"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Title size",
      "min": 24,
      "max": 60,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Maximum width",
      "min": 1000,
      "max": 1600,
      "step": 100,
      "unit": "px",
      "default": 1400
    },
    {
      "type": "range",
      "id": "section_padding",
      "label": "Section padding",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 60
    },
    {
      "type": "header",
      "content": "T-Shirt mockups"
    },
    {
      "type": "image_picker",
      "id": "tshirt_man_mockup",
      "label": "Adult man"
    },
    {
      "type": "image_picker",
      "id": "tshirt_woman_mockup",
      "label": "Adult woman"
    },
    {
      "type": "image_picker",
      "id": "tshirt_boy_mockup",
      "label": "Kids boy"
    },
    {
      "type": "image_picker",
      "id": "tshirt_girl_mockup",
      "label": "Kids girl"
    },
    {
      "type": "header",
      "content": "Hoodie mockups"
    },
    {
      "type": "image_picker",
      "id": "hoodie_man_mockup",
      "label": "Adult man"
    },
    {
      "type": "image_picker",
      "id": "hoodie_woman_mockup",
      "label": "Adult woman"
    },
    {
      "type": "image_picker",
      "id": "hoodie_boy_mockup",
      "label": "Kids boy"
    },
    {
      "type": "image_picker",
      "id": "hoodie_girl_mockup",
      "label": "Kids girl"
    },
    {
      "type": "header",
      "content": "Other product mockups"
    },
    {
      "type": "image_picker",
      "id": "cap_mockup",
      "label": "Cap"
    },
    {
      "type": "image_picker",
      "id": "hat_mockup",
      "label": "Hat"
    },
    {
      "type": "image_picker",
      "id": "bag_mockup",
      "label": "Bag"
    },
    {
      "type": "image_picker",
      "id": "shorts_mockup",
      "label": "Shorts"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "preview_bg_color",
      "label": "Preview background",
      "default": "#F9F9F9"
    },
    {
      "type": "color",
      "id": "card_bg_color",
      "label": "Card background",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#2C2C2C"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent",
      "default": "#FF9B8A"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border",
      "default": "#E0E0E0"
    },
    {
      "type": "header",
      "content": "Button style"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Background",
      "default": "#FF9B8A"
    },
    {
      "type": "color",
      "id": "button_hover_bg_color",
      "label": "Hover background",
      "default": "#FF7A63"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Text",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "button_radius",
      "label": "Border radius",
      "min": 0,
      "max": 40,
      "step": 4,
      "unit": "px",
      "default": 8
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Section border radius",
      "min": 0,
      "max": 40,
      "step": 4,
      "unit": "px",
      "default": 12
    },
    {
      "type": "header",
      "content": "Form settings"
    },
    {
      "type": "text",
      "id": "submit_button_text",
      "label": "Submit button text",
      "default": "Request Quote"
    },
    {
      "type": "textarea",
      "id": "success_message",
      "label": "Success message",
      "default": "Thank you! We'll send you a custom quote shortly."
    }
  ],
  "presets": [
    {
      "name": "Apparel customizer"
    }
  ]
}
{% endschema %}