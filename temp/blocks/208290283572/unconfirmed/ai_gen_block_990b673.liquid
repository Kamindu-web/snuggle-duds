{% doc %}
  @prompt
    I need a T-shirt, hoodie, cap, hat, bag, and shorts mockup design.
    
    Then
    When choosing T-shirts - Adults, Kids
    01) Adults - 2 options Male or Female
    02) Kids - 2 options Female or Male
    
    Or
    When choosing Hoodies - Adults, Kids
    01) Adults - 2 options Male or Female
    02) Kids - 2 options Female or Male
    
    T-shirts and Hoodies
    
    I want to change the t-shirt sample I have uploaded.
    
    I want to choose the unlimited upload option for our designs.
    
    Add an option to change the size and rotation of the gizmo display. The customer needs an option to upload the design. Select the size option, send me an email and get the parts, customer details.
    , I need a T-shirt, hoodie, cap, hat, bag, and shorts mockup design.
    
    Then
    When choosing T-shirts - Adults, Kids
    01) Adults - 2 options Male or Female
    02) Kids - 2 options Female or Male
    
    Or
    When choosing Hoodies - Adults, Kids
    01) Adults - 2 options Male or Female
    02) Kids - 2 options Female or Male
    
    T-shirts and Hoodies
    
    I want to change the t-shirt sample I have uploaded.
    
    Add an option to change the size and rotation of the gizmo display. The customer needs an option to upload the design. Select the size option, send me an email and get the parts, customer details., I need a T-shirt, hoodie, cap, hat, bag, and shorts mockup design.
    
    Then
    When choosing T-shirts - Adults, Kids
    01) Adults - 2 options Male or Female
    02) Kids - 2 options Female or Male
    
    Or
    When choosing Hoodies - Adults, Kids
    01) Adults - 2 options Male or Female
    02) Kids - 2 options Female or Male
    
    
    The customer needs an option to upload the designs.
    Add an option to change the size , place and rotation of the gizmo display. 
    
    send me an email and get the parts, customer details., I need a T-shirt, hoodie, cap, hat, bag and shorts mockup design.
    
    In it
    
    When choosing T-shirt - two options should be given as adults, children then
    01) Adults - 2 options male or female
    02) Children - 2 options female or male
    
    Or
    When choosing Hoodie - two options should be given as adults, children then
    01) Adults - 2 options male or female
    02) Children - 2 options female or male
    
    I need an option for the customer to upload the design.
    Add an option to change the size, position and rotation of the gizmo display.
    
    Send me an email and get the parts, customer details., I need a T-shirt, hoodie, cap, hat, bag and shorts mockup design.
    All sample images should be uploaded. Colors should be changeable.
    
    There
    
    When choosing T-shirts - two options should be given as adults, children then
    01) Adults - 2 options male or female
    02) Children - 2 options female or male
    
    Or
    When choosing Hoodies - two options should be given as adults, children then
    01) Adults - 2 options male or female
    02) Children - 2 options female or male
    
    Customer needs option to upload designs.
    Add option to change size, position and rotation of gizmo display.
    
    Send me an email and get parts, customer details.
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-mockup-designer-{{ ai_gen_id }} {
    display: block;
    width: {{ block.settings.desktop_width_percent }}%;
    max-width: 100%;
    padding: 40px;
    background-color: {{ block.settings.background_color }};
    border-radius: {{ block.settings.border_radius }}px;
  }

  .ai-mockup-designer__container-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 30px;
  }

  .ai-mockup-designer__heading-{{ ai_gen_id }} {
    font-size: {{ block.settings.heading_size }}px;
    color: {{ block.settings.text_color }};
    margin: 0 0 10px;
    text-align: center;
  }

  .ai-mockup-designer__subheading-{{ ai_gen_id }} {
    font-size: {{ block.settings.subheading_size }}px;
    color: {{ block.settings.text_color }};
    margin: 0 0 20px;
    text-align: center;
    opacity: 0.8;
  }

  .ai-mockup-designer__form-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .ai-mockup-designer__section-{{ ai_gen_id }} {
    background-color: {{ block.settings.section_bg_color }};
    padding: 20px;
    border-radius: 8px;
    border: 1px solid {{ block.settings.border_color }};
  }

  .ai-mockup-designer__section-title-{{ ai_gen_id }} {
    font-size: 18px;
    font-weight: 600;
    color: {{ block.settings.text_color }};
    margin: 0 0 15px;
  }

  .ai-mockup-designer__field-group-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 15px;
  }

  .ai-mockup-designer__label-{{ ai_gen_id }} {
    font-size: 14px;
    font-weight: 500;
    color: {{ block.settings.text_color }};
  }

  .ai-mockup-designer__select-{{ ai_gen_id }},
  .ai-mockup-designer__input-{{ ai_gen_id }} {
    padding: 12px 16px;
    border: 1px solid {{ block.settings.input_border_color }};
    border-radius: 4px;
    font-size: 14px;
    background-color: #ffffff;
    color: #121212;
  }

  .ai-mockup-designer__radio-group-{{ ai_gen_id }} {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
  }

  .ai-mockup-designer__radio-option-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .ai-mockup-designer__radio-option-{{ ai_gen_id }} input[type="radio"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  .ai-mockup-designer__radio-option-{{ ai_gen_id }} label {
    font-size: 14px;
    color: {{ block.settings.text_color }};
    cursor: pointer;
  }

  .ai-mockup-designer__color-picker-group-{{ ai_gen_id }} {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-wrap: wrap;
  }

  .ai-mockup-designer__color-option-{{ ai_gen_id }} {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 3px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .ai-mockup-designer__color-option-{{ ai_gen_id }}:hover {
    transform: scale(1.1);
  }

  .ai-mockup-designer__color-option-{{ ai_gen_id }}.active {
    border-color: {{ block.settings.button_color }};
    box-shadow: 0 0 0 2px #ffffff, 0 0 0 4px {{ block.settings.button_color }};
  }

  .ai-mockup-designer__preview-area-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    min-height: 500px;
    background-color: #f9f9f9;
    border: 2px dashed {{ block.settings.border_color }};
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .ai-mockup-designer__mockup-image-{{ ai_gen_id }} {
    max-width: 100%;
    max-height: 500px;
    object-fit: contain;
    position: relative;
    z-index: 1;
  }

  .ai-mockup-designer__design-overlay-{{ ai_gen_id }} {
    position: absolute;
    cursor: move;
    touch-action: none;
    z-index: 2;
    user-select: none;
  }

  .ai-mockup-designer__design-overlay-{{ ai_gen_id }} img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    pointer-events: none;
  }

  .ai-mockup-designer__placeholder-{{ ai_gen_id }} {
    text-align: center;
    color: #999;
    font-size: 16px;
    padding: 20px;
  }

  .ai-mockup-designer__upload-area-{{ ai_gen_id }} {
    border: 2px dashed {{ block.settings.input_border_color }};
    border-radius: 8px;
    padding: 30px;
    text-align: center;
    background-color: #fafafa;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .ai-mockup-designer__upload-area-{{ ai_gen_id }}:hover {
    border-color: {{ block.settings.button_color }};
    background-color: #f0f0f0;
  }

  .ai-mockup-designer__upload-icon-{{ ai_gen_id }} {
    width: 48px;
    height: 48px;
    margin: 0 auto 10px;
    color: {{ block.settings.button_color }};
  }

  .ai-mockup-designer__upload-text-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.text_color }};
    margin-bottom: 5px;
  }

  .ai-mockup-designer__upload-hint-{{ ai_gen_id }} {
    font-size: 12px;
    color: #999;
  }

  .ai-mockup-designer__file-input-{{ ai_gen_id }} {
    display: none;
  }

  .ai-mockup-designer__uploaded-files-{{ ai_gen_id }} {
    margin-top: 15px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .ai-mockup-designer__file-item-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px;
    background-color: #ffffff;
    border: 1px solid {{ block.settings.border_color }};
    border-radius: 4px;
    font-size: 13px;
  }

  .ai-mockup-designer__file-remove-{{ ai_gen_id }} {
    background: none;
    border: none;
    color: #d32f2f;
    cursor: pointer;
    font-size: 18px;
    padding: 0 5px;
  }

  .ai-mockup-designer__controls-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
  }

  .ai-mockup-designer__slider-group-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .ai-mockup-designer__slider-{{ ai_gen_id }} {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: #ddd;
    outline: none;
    -webkit-appearance: none;
  }

  .ai-mockup-designer__slider-{{ ai_gen_id }}::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: {{ block.settings.button_color }};
    cursor: pointer;
  }

  .ai-mockup-designer__slider-{{ ai_gen_id }}::-moz-range-thumb {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: {{ block.settings.button_color }};
    cursor: pointer;
    border: none;
  }

  .ai-mockup-designer__slider-value-{{ ai_gen_id }} {
    font-size: 12px;
    color: {{ block.settings.text_color }};
    text-align: right;
  }

  .ai-mockup-designer__button-{{ ai_gen_id }} {
    padding: 16px 32px;
    background-color: {{ block.settings.button_color }};
    color: {{ block.settings.button_text_color }};
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
  }

  .ai-mockup-designer__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_color }};
  }

  .ai-mockup-designer__button-{{ ai_gen_id }}:disabled {
    background-color: #ccc;
    cursor: not-allowed;
  }

  .ai-mockup-designer__success-{{ ai_gen_id }} {
    padding: 15px;
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
    border-radius: 4px;
    text-align: center;
    margin-top: 15px;
  }

  .ai-mockup-designer__error-{{ ai_gen_id }} {
    padding: 15px;
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    border-radius: 4px;
    text-align: center;
    margin-top: 15px;
  }

  .ai-mockup-designer__hidden-{{ ai_gen_id }} {
    display: none;
  }

  @media screen and (max-width: 749px) {
    .ai-mockup-designer-{{ ai_gen_id }} {
      padding: 20px;
    }

    .ai-mockup-designer__controls-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
    }

    .ai-mockup-designer__preview-area-{{ ai_gen_id }} {
      min-height: 350px;
    }

    .ai-mockup-designer__mockup-image-{{ ai_gen_id }} {
      max-height: 350px;
    }
  }
{% endstyle %}

<product-mockup-designer-{{ ai_gen_id }}
  class="ai-mockup-designer-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-mockup-designer__container-{{ ai_gen_id }}">
    {% if block.settings.heading != blank %}
      <h2 class="ai-mockup-designer__heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
    {% endif %}

    {% if block.settings.subheading != blank %}
      <p class="ai-mockup-designer__subheading-{{ ai_gen_id }}">{{ block.settings.subheading }}</p>
    {% endif %}

    {%- form 'contact' -%}
      <input type="hidden" name="contact[subject]" value="Custom Mockup Design Request">
      <div class="ai-mockup-designer__form-{{ ai_gen_id }}">
        <div class="ai-mockup-designer__section-{{ ai_gen_id }}">
          <h3 class="ai-mockup-designer__section-title-{{ ai_gen_id }}">Product Selection</h3>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="product-type-{{ ai_gen_id }}">
              Product Type
            </label>
            <select
              id="product-type-{{ ai_gen_id }}"
              name="contact[product_type]"
              class="ai-mockup-designer__select-{{ ai_gen_id }}"
              required
            >
              <option value="">Select a product</option>
              <option value="tshirt">T-Shirt</option>
              <option value="hoodie">Hoodie</option>
              <option value="cap">Cap</option>
              <option value="hat">Hat</option>
              <option value="bag">Bag</option>
              <option value="shorts">Shorts</option>
            </select>
          </div>

          <div
            id="category-section-{{ ai_gen_id }}"
            class="ai-mockup-designer__field-group-{{ ai_gen_id }} ai-mockup-designer__hidden-{{ ai_gen_id }}"
          >
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}">Category</label>
            <div class="ai-mockup-designer__radio-group-{{ ai_gen_id }}">
              <div class="ai-mockup-designer__radio-option-{{ ai_gen_id }}">
                <input
                  type="radio"
                  id="category-adults-{{ ai_gen_id }}"
                  name="contact[category]"
                  value="adults"
                >
                <label for="category-adults-{{ ai_gen_id }}">Adults</label>
              </div>
              <div class="ai-mockup-designer__radio-option-{{ ai_gen_id }}">
                <input
                  type="radio"
                  id="category-kids-{{ ai_gen_id }}"
                  name="contact[category]"
                  value="kids"
                >
                <label for="category-kids-{{ ai_gen_id }}">Kids</label>
              </div>
            </div>
          </div>

          <div
            id="gender-section-{{ ai_gen_id }}"
            class="ai-mockup-designer__field-group-{{ ai_gen_id }} ai-mockup-designer__hidden-{{ ai_gen_id }}"
          >
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}">Gender</label>
            <div class="ai-mockup-designer__radio-group-{{ ai_gen_id }}">
              <div class="ai-mockup-designer__radio-option-{{ ai_gen_id }}">
                <input
                  type="radio"
                  id="gender-male-{{ ai_gen_id }}"
                  name="contact[gender]"
                  value="male"
                >
                <label for="gender-male-{{ ai_gen_id }}">Male</label>
              </div>
              <div class="ai-mockup-designer__radio-option-{{ ai_gen_id }}">
                <input
                  type="radio"
                  id="gender-female-{{ ai_gen_id }}"
                  name="contact[gender]"
                  value="female"
                >
                <label for="gender-female-{{ ai_gen_id }}">Female</label>
              </div>
            </div>
          </div>

          <div
            id="color-section-{{ ai_gen_id }}"
            class="ai-mockup-designer__field-group-{{ ai_gen_id }} ai-mockup-designer__hidden-{{ ai_gen_id }}"
          >
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}">Product Color</label>
            <div class="ai-mockup-designer__color-picker-group-{{ ai_gen_id }}">
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="white"
                style="background-color: #ffffff; border: 1px solid #ddd;"
                title="White"
              ></div>
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="black"
                style="background-color: #000000;"
                title="Black"
              ></div>
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="navy"
                style="background-color: #001f3f;"
                title="Navy"
              ></div>
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="red"
                style="background-color: #e74c3c;"
                title="Red"
              ></div>
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="blue"
                style="background-color: #3498db;"
                title="Blue"
              ></div>
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="green"
                style="background-color: #27ae60;"
                title="Green"
              ></div>
              <div
                class="ai-mockup-designer__color-option-{{ ai_gen_id }}"
                data-color="gray"
                style="background-color: #95a5a6;"
                title="Gray"
              ></div>
            </div>
            <input type="hidden" id="selected-color-{{ ai_gen_id }}" name="contact[product_color]">
          </div>
        </div>

        <div class="ai-mockup-designer__section-{{ ai_gen_id }}">
          <h3 class="ai-mockup-designer__section-title-{{ ai_gen_id }}">Design Preview</h3>

          <div
            id="preview-area-{{ ai_gen_id }}"
            class="ai-mockup-designer__preview-area-{{ ai_gen_id }}"
          >
            <div class="ai-mockup-designer__placeholder-{{ ai_gen_id }}">
              Select a product to see the mockup
            </div>
          </div>
        </div>

        <div class="ai-mockup-designer__section-{{ ai_gen_id }}">
          <h3 class="ai-mockup-designer__section-title-{{ ai_gen_id }}">Upload Your Design</h3>

          <div
            id="upload-area-{{ ai_gen_id }}"
            class="ai-mockup-designer__upload-area-{{ ai_gen_id }}"
          >
            <svg
              class="ai-mockup-designer__upload-icon-{{ ai_gen_id }}"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
              />
            </svg>
            <div class="ai-mockup-designer__upload-text-{{ ai_gen_id }}">
              Click to upload or drag and drop
            </div>
            <div class="ai-mockup-designer__upload-hint-{{ ai_gen_id }}">
              PNG, JPG, SVG (MAX. 5MB) - Upload multiple files
            </div>
          </div>
          <input
            type="file"
            id="design-upload-{{ ai_gen_id }}"
            class="ai-mockup-designer__file-input-{{ ai_gen_id }}"
            accept="image/png,image/jpeg,image/svg+xml"
            multiple
          >
          <div id="uploaded-files-{{ ai_gen_id }}" class="ai-mockup-designer__uploaded-files-{{ ai_gen_id }}"></div>
          <input type="hidden" id="design-data-{{ ai_gen_id }}" name="contact[design_files]">
        </div>

        <div
          id="controls-section-{{ ai_gen_id }}"
          class="ai-mockup-designer__section-{{ ai_gen_id }} ai-mockup-designer__hidden-{{ ai_gen_id }}"
        >
          <h3 class="ai-mockup-designer__section-title-{{ ai_gen_id }}">Adjust Design</h3>

          <div class="ai-mockup-designer__controls-{{ ai_gen_id }}">
            <div class="ai-mockup-designer__slider-group-{{ ai_gen_id }}">
              <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="size-slider-{{ ai_gen_id }}">
                Size
              </label>
              <input
                type="range"
                id="size-slider-{{ ai_gen_id }}"
                class="ai-mockup-designer__slider-{{ ai_gen_id }}"
                min="50"
                max="400"
                value="150"
              >
              <div class="ai-mockup-designer__slider-value-{{ ai_gen_id }}">
                <span id="size-value-{{ ai_gen_id }}">150</span>px
              </div>
              <input type="hidden" id="size-input-{{ ai_gen_id }}" name="contact[design_size]" value="150">
            </div>

            <div class="ai-mockup-designer__slider-group-{{ ai_gen_id }}">
              <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="rotation-slider-{{ ai_gen_id }}">
                Rotation
              </label>
              <input
                type="range"
                id="rotation-slider-{{ ai_gen_id }}"
                class="ai-mockup-designer__slider-{{ ai_gen_id }}"
                min="0"
                max="360"
                value="0"
              >
              <div class="ai-mockup-designer__slider-value-{{ ai_gen_id }}">
                <span id="rotation-value-{{ ai_gen_id }}">0</span>°
              </div>
              <input type="hidden" id="rotation-input-{{ ai_gen_id }}" name="contact[design_rotation]" value="0">
            </div>

            <div class="ai-mockup-designer__slider-group-{{ ai_gen_id }}">
              <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="x-position-slider-{{ ai_gen_id }}">
                Horizontal Position
              </label>
              <input
                type="range"
                id="x-position-slider-{{ ai_gen_id }}"
                class="ai-mockup-designer__slider-{{ ai_gen_id }}"
                min="0"
                max="100"
                value="50"
              >
              <div class="ai-mockup-designer__slider-value-{{ ai_gen_id }}">
                <span id="x-position-value-{{ ai_gen_id }}">50</span>%
              </div>
              <input type="hidden" id="x-position-input-{{ ai_gen_id }}" name="contact[design_x_position]" value="50">
            </div>

            <div class="ai-mockup-designer__slider-group-{{ ai_gen_id }}">
              <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="y-position-slider-{{ ai_gen_id }}">
                Vertical Position
              </label>
              <input
                type="range"
                id="y-position-slider-{{ ai_gen_id }}"
                class="ai-mockup-designer__slider-{{ ai_gen_id }}"
                min="0"
                max="100"
                value="50"
              >
              <div class="ai-mockup-designer__slider-value-{{ ai_gen_id }}">
                <span id="y-position-value-{{ ai_gen_id }}">50</span>%
              </div>
              <input type="hidden" id="y-position-input-{{ ai_gen_id }}" name="contact[design_y_position]" value="50">
            </div>
          </div>
        </div>

        <div class="ai-mockup-designer__section-{{ ai_gen_id }}">
          <h3 class="ai-mockup-designer__section-title-{{ ai_gen_id }}">Your Details</h3>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="customer-name-{{ ai_gen_id }}">
              Full Name
            </label>
            <input
              type="text"
              id="customer-name-{{ ai_gen_id }}"
              name="contact[name]"
              class="ai-mockup-designer__input-{{ ai_gen_id }}"
              required
            >
          </div>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="customer-email-{{ ai_gen_id }}">
              Email Address
            </label>
            <input
              type="email"
              id="customer-email-{{ ai_gen_id }}"
              name="contact[email]"
              class="ai-mockup-designer__input-{{ ai_gen_id }}"
              required
              {% if form.errors %}
                aria-invalid="true"
                aria-describedby="email-error-{{ ai_gen_id }}"
              {% endif %}
            >
            {%- if form.errors -%}
              <div id="email-error-{{ ai_gen_id }}" class="ai-mockup-designer__error-{{ ai_gen_id }}">
                {{ form.errors.messages.email }}
              </div>
            {%- endif -%}
          </div>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="customer-phone-{{ ai_gen_id }}">
              Phone Number
            </label>
            <input
              type="tel"
              id="customer-phone-{{ ai_gen_id }}"
              name="contact[phone]"
              class="ai-mockup-designer__input-{{ ai_gen_id }}"
            >
          </div>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="size-selection-{{ ai_gen_id }}">
              Size
            </label>
            <select
              id="size-selection-{{ ai_gen_id }}"
              name="contact[size]"
              class="ai-mockup-designer__select-{{ ai_gen_id }}"
              required
            >
              <option value="">Select size</option>
              <option value="xs">XS</option>
              <option value="s">S</option>
              <option value="m">M</option>
              <option value="l">L</option>
              <option value="xl">XL</option>
              <option value="xxl">XXL</option>
            </select>
          </div>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="quantity-{{ ai_gen_id }}">
              Quantity
            </label>
            <input
              type="number"
              id="quantity-{{ ai_gen_id }}"
              name="contact[quantity]"
              class="ai-mockup-designer__input-{{ ai_gen_id }}"
              min="1"
              value="1"
              required
            >
          </div>

          <div class="ai-mockup-designer__field-group-{{ ai_gen_id }}">
            <label class="ai-mockup-designer__label-{{ ai_gen_id }}" for="notes-{{ ai_gen_id }}">
              Additional Notes
            </label>
            <textarea
              id="notes-{{ ai_gen_id }}"
              name="contact[body]"
              class="ai-mockup-designer__input-{{ ai_gen_id }}"
              rows="4"
              placeholder="Any special requests or instructions..."
            ></textarea>
          </div>
        </div>

        <button
          type="submit"
          class="ai-mockup-designer__button-{{ ai_gen_id }}"
          id="submit-button-{{ ai_gen_id }}"
        >
          {{ block.settings.button_text }}
        </button>

        {%- if form.posted_successfully? -%}
          <div class="ai-mockup-designer__success-{{ ai_gen_id }}">
            {{ block.settings.success_message }}
          </div>
        {%- endif -%}
      </div>
    {%- endform -%}
  </div>
</product-mockup-designer-{{ ai_gen_id }}>

<script>
  (function() {
    class ProductMockupDesigner{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.productType = null;
        this.category = null;
        this.gender = null;
        this.selectedColor = null;
        this.uploadedDesigns = [];
        this.currentDesignIndex = 0;
        this.isDragging = false;
        this.dragStartX = 0;
        this.dragStartY = 0;
        this.designX = 50;
        this.designY = 50;
        this.mockupImages = {
          tshirt: {
            adults: {
              male: '{{ block.settings.tshirt_adult_male | image_url: width: 800 }}',
              female: '{{ block.settings.tshirt_adult_female | image_url: width: 800 }}'
            },
            kids: {
              male: '{{ block.settings.tshirt_kids_male | image_url: width: 800 }}',
              female: '{{ block.settings.tshirt_kids_female | image_url: width: 800 }}'
            }
          },
          hoodie: {
            adults: {
              male: '{{ block.settings.hoodie_adult_male | image_url: width: 800 }}',
              female: '{{ block.settings.hoodie_adult_female | image_url: width: 800 }}'
            },
            kids: {
              male: '{{ block.settings.hoodie_kids_male | image_url: width: 800 }}',
              female: '{{ block.settings.hoodie_kids_female | image_url: width: 800 }}'
            }
          },
          cap: '{{ block.settings.cap_image | image_url: width: 800 }}',
          hat: '{{ block.settings.hat_image | image_url: width: 800 }}',
          bag: '{{ block.settings.bag_image | image_url: width: 800 }}',
          shorts: '{{ block.settings.shorts_image | image_url: width: 800 }}'
        };
      }

      connectedCallback() {
        this.productTypeSelect = this.querySelector('#product-type-{{ ai_gen_id }}');
        this.categorySection = this.querySelector('#category-section-{{ ai_gen_id }}');
        this.genderSection = this.querySelector('#gender-section-{{ ai_gen_id }}');
        this.colorSection = this.querySelector('#color-section-{{ ai_gen_id }}');
        this.previewArea = this.querySelector('#preview-area-{{ ai_gen_id }}');
        this.uploadArea = this.querySelector('#upload-area-{{ ai_gen_id }}');
        this.fileInput = this.querySelector('#design-upload-{{ ai_gen_id }}');
        this.uploadedFilesContainer = this.querySelector('#uploaded-files-{{ ai_gen_id }}');
        this.controlsSection = this.querySelector('#controls-section-{{ ai_gen_id }}');
        this.designDataInput = this.querySelector('#design-data-{{ ai_gen_id }}');
        this.selectedColorInput = this.querySelector('#selected-color-{{ ai_gen_id }}');

        this.sizeSlider = this.querySelector('#size-slider-{{ ai_gen_id }}');
        this.sizeValue = this.querySelector('#size-value-{{ ai_gen_id }}');
        this.sizeInput = this.querySelector('#size-input-{{ ai_gen_id }}');

        this.rotationSlider = this.querySelector('#rotation-slider-{{ ai_gen_id }}');
        this.rotationValue = this.querySelector('#rotation-value-{{ ai_gen_id }}');
        this.rotationInput = this.querySelector('#rotation-input-{{ ai_gen_id }}');

        this.xPositionSlider = this.querySelector('#x-position-slider-{{ ai_gen_id }}');
        this.xPositionValue = this.querySelector('#x-position-value-{{ ai_gen_id }}');
        this.xPositionInput = this.querySelector('#x-position-input-{{ ai_gen_id }}');

        this.yPositionSlider = this.querySelector('#y-position-slider-{{ ai_gen_id }}');
        this.yPositionValue = this.querySelector('#y-position-value-{{ ai_gen_id }}');
        this.yPositionInput = this.querySelector('#y-position-input-{{ ai_gen_id }}');

        this.setupEventListeners();
      }

      setupEventListeners() {
        this.productTypeSelect.addEventListener('change', (e) => this.handleProductTypeChange(e));

        this.querySelectorAll('input[name="contact[category]"]').forEach((radio) => {
          radio.addEventListener('change', (e) => this.handleCategoryChange(e));
        });

        this.querySelectorAll('input[name="contact[gender]"]').forEach((radio) => {
          radio.addEventListener('change', (e) => this.handleGenderChange(e));
        });

        this.querySelectorAll('.ai-mockup-designer__color-option-{{ ai_gen_id }}').forEach((colorOption) => {
          colorOption.addEventListener('click', (e) => this.handleColorChange(e));
        });

        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileUpload(e));

        this.uploadArea.addEventListener('dragover', (e) => {
          e.preventDefault();
          this.uploadArea.style.borderColor = '{{ block.settings.button_color }}';
        });

        this.uploadArea.addEventListener('dragleave', () => {
          this.uploadArea.style.borderColor = '{{ block.settings.input_border_color }}';
        });

        this.uploadArea.addEventListener('drop', (e) => {
          e.preventDefault();
          this.uploadArea.style.borderColor = '{{ block.settings.input_border_color }}';
          this.handleFileUpload({ target: { files: e.dataTransfer.files } });
        });

        this.sizeSlider.addEventListener('input', (e) => {
          this.sizeValue.textContent = e.target.value;
          this.sizeInput.value = e.target.value;
          this.updateDesignTransform();
        });

        this.rotationSlider.addEventListener('input', (e) => {
          this.rotationValue.textContent = e.target.value;
          this.rotationInput.value = e.target.value;
          this.updateDesignTransform();
        });

        this.xPositionSlider.addEventListener('input', (e) => {
          this.xPositionValue.textContent = e.target.value;
          this.xPositionInput.value = e.target.value;
          this.designX = parseFloat(e.target.value);
          this.updateDesignPosition();
        });

        this.yPositionSlider.addEventListener('input', (e) => {
          this.yPositionValue.textContent = e.target.value;
          this.yPositionInput.value = e.target.value;
          this.designY = parseFloat(e.target.value);
          this.updateDesignPosition();
        });
      }

      handleProductTypeChange(e) {
        this.productType = e.target.value;

        if (this.productType === 'tshirt' || this.productType === 'hoodie') {
          this.categorySection.classList.remove('ai-mockup-designer__hidden-{{ ai_gen_id }}');
          this.colorSection.classList.remove('ai-mockup-designer__hidden-{{ ai_gen_id }}');
        } else {
          this.categorySection.classList.add('ai-mockup-designer__hidden-{{ ai_gen_id }}');
          this.genderSection.classList.add('ai-mockup-designer__hidden-{{ ai_gen_id }}');
          this.colorSection.classList.remove('ai-mockup-designer__hidden-{{ ai_gen_id }}');
          this.updateMockupPreview();
        }
      }

      handleCategoryChange(e) {
        this.category = e.target.value;
        this.genderSection.classList.remove('ai-mockup-designer__hidden-{{ ai_gen_id }}');
      }

      handleGenderChange(e) {
        this.gender = e.target.value;
        this.updateMockupPreview();
      }

      handleColorChange(e) {
        this.querySelectorAll('.ai-mockup-designer__color-option-{{ ai_gen_id }}').forEach((option) => {
          option.classList.remove('active');
        });

        e.currentTarget.classList.add('active');
        this.selectedColor = e.currentTarget.getAttribute('data-color');
        this.selectedColorInput.value = this.selectedColor;
      }

      updateMockupPreview() {
        let mockupImageUrl = null;

        if (this.productType === 'tshirt' || this.productType === 'hoodie') {
          if (this.category && this.gender) {
            mockupImageUrl = this.mockupImages[this.productType][this.category][this.gender];
          }
        } else if (this.productType) {
          mockupImageUrl = this.mockupImages[this.productType];
        }

        if (mockupImageUrl && mockupImageUrl !== '') {
          this.previewArea.innerHTML = '<img src="' + mockupImageUrl + '" alt="Product mockup" class="ai-mockup-designer__mockup-image-{{ ai_gen_id }}">';
        } else {
          let displayText = 'Select a product to see the mockup';
          if (this.productType) {
            displayText = 'Mockup for ' + this.productType;
            if (this.category) displayText += ' - ' + this.category;
            if (this.gender) displayText += ' - ' + this.gender;
          }
          this.previewArea.innerHTML = '<div class="ai-mockup-designer__placeholder-{{ ai_gen_id }}">' + displayText + '</div>';
        }

        if (this.uploadedDesigns.length > 0) {
          this.renderDesignOverlay();
        }
      }

      handleFileUpload(e) {
        const files = Array.from(e.target.files);

        files.forEach((file) => {
          if (file.size > 5 * 1024 * 1024) {
            alert('File size must be less than 5MB: ' + file.name);
            return;
          }

          const reader = new FileReader();
          reader.onload = (event) => {
            this.uploadedDesigns.push({
              name: file.name,
              data: event.target.result
            });

            this.updateUploadedFilesList();
            this.designDataInput.value = JSON.stringify(this.uploadedDesigns.map(d => d.name));

            this.controlsSection.classList.remove('ai-mockup-designer__hidden-{{ ai_gen_id }}');
            
            if (this.uploadedDesigns.length === 1) {
              this.renderDesignOverlay();
            }
          };
          reader.readAsDataURL(file);
        });
      }

      updateUploadedFilesList() {
        this.uploadedFilesContainer.innerHTML = '';

        this.uploadedDesigns.forEach((design, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'ai-mockup-designer__file-item-{{ ai_gen_id }}';
          fileItem.innerHTML = '<span>' + design.name + '</span><button type="button" class="ai-mockup-designer__file-remove-{{ ai_gen_id }}" data-index="' + index + '">×</button>';

          const removeButton = fileItem.querySelector('.ai-mockup-designer__file-remove-{{ ai_gen_id }}');
          removeButton.addEventListener('click', () => this.removeDesign(index));

          this.uploadedFilesContainer.appendChild(fileItem);
        });
      }

      removeDesign(index) {
        this.uploadedDesigns.splice(index, 1);
        this.updateUploadedFilesList();
        this.designDataInput.value = JSON.stringify(this.uploadedDesigns.map(d => d.name));

        if (this.uploadedDesigns.length === 0) {
          this.controlsSection.classList.add('ai-mockup-designer__hidden-{{ ai_gen_id }}');
          const overlay = this.previewArea.querySelector('.ai-mockup-designer__design-overlay-{{ ai_gen_id }}');
          if (overlay) overlay.remove();
        } else {
          this.currentDesignIndex = Math.min(this.currentDesignIndex, this.uploadedDesigns.length - 1);
          this.renderDesignOverlay();
        }
      }

      renderDesignOverlay() {
        const existingOverlay = this.previewArea.querySelector('.ai-mockup-designer__design-overlay-{{ ai_gen_id }}');
        if (existingOverlay) {
          existingOverlay.remove();
        }

        if (this.uploadedDesigns.length === 0) return;

        const overlay = document.createElement('div');
        overlay.className = 'ai-mockup-designer__design-overlay-{{ ai_gen_id }}';
        overlay.style.width = this.sizeSlider.value + 'px';
        overlay.style.height = this.sizeSlider.value + 'px';
        overlay.style.left = this.designX + '%';
        overlay.style.top = this.designY + '%';
        overlay.style.transform = 'translate(-50%, -50%) rotate(' + this.rotationSlider.value + 'deg)';

        const img = document.createElement('img');
        img.src = this.uploadedDesigns[this.currentDesignIndex].data;
        img.alt = 'Uploaded design';

        overlay.appendChild(img);
        this.previewArea.appendChild(overlay);

        this.setupDragListeners(overlay);
      }

      setupDragListeners(overlay) {
        overlay.addEventListener('mousedown', (e) => this.startDrag(e, overlay));
        overlay.addEventListener('touchstart', (e) => this.startDrag(e, overlay));

        document.addEventListener('mousemove', (e) => this.drag(e, overlay));
        document.addEventListener('touchmove', (e) => this.drag(e, overlay));

        document.addEventListener('mouseup', () => this.endDrag());
        document.addEventListener('touchend', () => this.endDrag());
      }

      startDrag(e, overlay) {
        this.isDragging = true;
        const rect = this.previewArea.getBoundingClientRect();
        const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

        this.dragStartX = clientX - rect.left;
        this.dragStartY = clientY - rect.top;
      }

      drag(e, overlay) {
        if (!this.isDragging) return;

        e.preventDefault();
        const rect = this.previewArea.getBoundingClientRect();
        const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

        const x = ((clientX - rect.left) / rect.width) * 100;
        const y = ((clientY - rect.top) / rect.height) * 100;

        this.designX = Math.max(0, Math.min(100, x));
        this.designY = Math.max(0, Math.min(100, y));

        this.xPositionSlider.value = this.designX;
        this.xPositionValue.textContent = Math.round(this.designX);
        this.xPositionInput.value = Math.round(this.designX);

        this.yPositionSlider.value = this.designY;
        this.yPositionValue.textContent = Math.round(this.designY);
        this.yPositionInput.value = Math.round(this.designY);

        this.updateDesignPosition();
      }

      endDrag() {
        this.isDragging = false;
      }

      updateDesignPosition() {
        const overlay = this.previewArea.querySelector('.ai-mockup-designer__design-overlay-{{ ai_gen_id }}');
        if (overlay) {
          overlay.style.left = this.designX + '%';
          overlay.style.top = this.designY + '%';
        }
      }

      updateDesignTransform() {
        const overlay = this.previewArea.querySelector('.ai-mockup-designer__design-overlay-{{ ai_gen_id }}');
        if (overlay) {
          overlay.style.width = this.sizeSlider.value + 'px';
          overlay.style.height = this.sizeSlider.value + 'px';
          overlay.style.transform = 'translate(-50%, -50%) rotate(' + this.rotationSlider.value + 'deg)';
        }
      }
    }

    customElements.define('product-mockup-designer-{{ ai_gen_id }}', ProductMockupDesigner{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Product mockup designer",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Heading",
      "default": "Design Your Custom Product"
    },
    {
      "type": "inline_richtext",
      "id": "subheading",
      "label": "Subheading",
      "default": "Create your perfect custom apparel with our easy-to-use designer"
    },
    {
      "type": "inline_richtext",
      "id": "button_text",
      "label": "Button text",
      "default": "Submit Design Request"
    },
    {
      "type": "inline_richtext",
      "id": "success_message",
      "label": "Success message",
      "default": "Thank you! We've received your design request and will contact you shortly."
    },
    {
      "type": "header",
      "content": "T-shirt mockup images"
    },
    {
      "type": "image_picker",
      "id": "tshirt_adult_male",
      "label": "Adult male"
    },
    {
      "type": "image_picker",
      "id": "tshirt_adult_female",
      "label": "Adult female"
    },
    {
      "type": "image_picker",
      "id": "tshirt_kids_male",
      "label": "Kids male"
    },
    {
      "type": "image_picker",
      "id": "tshirt_kids_female",
      "label": "Kids female"
    },
    {
      "type": "header",
      "content": "Hoodie mockup images"
    },
    {
      "type": "image_picker",
      "id": "hoodie_adult_male",
      "label": "Adult male"
    },
    {
      "type": "image_picker",
      "id": "hoodie_adult_female",
      "label": "Adult female"
    },
    {
      "type": "image_picker",
      "id": "hoodie_kids_male",
      "label": "Kids male"
    },
    {
      "type": "image_picker",
      "id": "hoodie_kids_female",
      "label": "Kids female"
    },
    {
      "type": "header",
      "content": "Other product mockup images"
    },
    {
      "type": "image_picker",
      "id": "cap_image",
      "label": "Cap"
    },
    {
      "type": "image_picker",
      "id": "hat_image",
      "label": "Hat"
    },
    {
      "type": "image_picker",
      "id": "bag_image",
      "label": "Bag"
    },
    {
      "type": "image_picker",
      "id": "shorts_image",
      "label": "Shorts"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "desktop_width_percent",
      "label": "Desktop width",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 100
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 8
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Section background",
      "default": "#f9f9f9"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Input border",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button background",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Button hover background",
      "default": "#334FB4"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "heading_size",
      "label": "Heading size",
      "min": 20,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 32
    },
    {
      "type": "range",
      "id": "subheading_size",
      "label": "Subheading size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    }
  ],
  "presets": [
    {
      "name": "Product mockup designer"
    }
  ]
}
{% endschema %}